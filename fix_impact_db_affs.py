# -*- coding: utf-8 -*-
import sys
import re
import MySQLdb
from invenio.search_engine import perform_request_search, get_record
from invenio.bibrecord import record_get_field_value


impact_db = MySQLdb.connect(host="localhost",
                            user="user",
                            passwd="password",
                            db="impact")
impact_db_c = impact_db.cursor()


def get_short_affiliation_inspire(short_aff_rec):
    country = record_get_field_value(short_aff_rec, tag='371', code='g')
    if not country:
        country = record_get_field_value(short_aff_rec, tag='371', code='d')
    if '510' in short_aff_rec:
        short_aff_rec = get_record(record_get_field_value(short_aff_rec, tag='510', code='0'))
    institute = record_get_field_value(short_aff_rec, tag='110', code='g')
    ins = ['cern', 'kek', 'fnal', 'slac', 'desy', 'jinr']
    for i in ins:
        if i in institute.lower():
            country = i.upper()
    return country


def create_affiliation_entry_aps(id, affiliation):
    country = None
    country_id = None
    short_affiliation = perform_request_search(p="110__u:'{affiliation}'".format(affiliation=affiliation), cc="Institutions")
    if short_affiliation:
        short_aff_rec = get_record(short_affiliation[0])
        country = get_short_affiliation_inspire(short_aff_rec)
    else:
        print "Can't find this affiliation: %s" % (affiliation,)

    if country:
        if impact_db_c.execute("SELECT idcountry FROM country WHERE country_name LIKE %s", (country,)):
            country_id = impact_db_c.fetchone()[0]
        if not country_id:
            if impact_db_c.execute("SELECT idcountry FROM country WHERE code LIKE %s", (country,)):
                country_id = impact_db_c.fetchone()[0]
        if country_id:
            print "%s, %s - adding country: %s" % (id, affiliation, country_id)
            impact_db_c.execute("""UPDATE affiliation
                                   SET idcountry=%s
                                   WHERE idaffiliation=%s""", (country_id, id))
    else:
            print "%s, %s - Error adding country: %s" % (id, affiliation, country)
    else:
        print "%s, %s - Error adding country: %s" % (id, affiliation, country)


fix_it = [(925,"Web Institute of Physics"),
    (15406,"Cambridge U., DAMTP"),
    (15411,"Jena U., TPI"),
    (15416,"Res. Group Stat. Biol., Budapest"),
    (15419,"Paris U. VI, GRECO"),
    (15450,"Ewha Women's U., Seoul"),
    (15454,"Cambridge U., KICC"),
    (15455,"Cambridge U."),
    (15456,"CQUeST, Seoul"),
    (15458,"APCTP, Pohang"),
    (15473,"Pune U."),
    (15475,"Cape Town U., Dept. Math."),
    (15476,"Oxford U."),
    (15480,"Unlisted"),
    (15482,"IKP, Forschungszentrum Juelich"),
    (15503,"Ocean U."),
    (15504,"Henan Polytech. U."),
    (15518,"UNAM, Mexico"),
    (15523,"Durham U., IPPP"),
    (15528,"Shanxi Normal U."),
    (15536,"Lahore U. Mgt. Sci."),
    (15540,"Indian Inst. Tech., Hyderabad"),
    (15568,"Brunel U."),
    (15580,"Edinburgh U."),
    (15586,"Indian Inst. Tech., Guwahati"),
    (15600,"Manchester U., Comp. Sci. Dept."),
    (15618,"Rutherford"),
    (15633,"University Coll., Dublin, Math. Phys."),
    (15634,"University Coll., Dublin, CASL"),
    (15640,"UC Davis"),
    (15641,"Newton Inst. Math. Sci., Cambridge"),
    (15656,"Nara Women's U."),
    (15661,"Fu Jen Catholic U."),
    (15673,"Gottingen U., Zweites Phys. Inst."),
    (15681,"Nara U. of Education"),
    (15685,"Korea U."),
    (15690,"Indian Inst. Tech., Madras"),
    (15698,"IKERBASQUE, Bilbao"),
    (15706,"Indian Association for the Cultivation of Science"),
    (15710,"Natl. U. Defense Tech., Hunan"),
    (15716,"OCAMI, Osaka"),
    (15722,"IACS, India"),
    (15726,"Southampton U."),
    (15728,"Parana U."),
    (15729,"Mexico U., Cuernavaca"),
    (15731,"Guadalajara U."),
    (15735,"Cyprus Inst."),
    (15737,"Frederick Inst. Tech."),
    (15739,"Oxford U., Inst. Math."),
    (15744,"Taipei Municipal U. of Education"),
    (15746,"ICG Portsmouth"),
    (15747,"CEA Saclay"),
    (15748,"Tezpur U."),
    (15753,"Colombia, U. Natl."),
    (15762,"KLTE-ATOMKI"),
    (15763,"Debrecen U."),
    (15764,"Swansea U."),
    (15772,"Diego Portales U."),
    (15773,"La Serena U."),
    (15774,"Frontera U."),
    (15775,"Burdwan U."),
    (15778,"Albert Einstein Inst."),
    (15780,"UESTC, Chengdu"),
    (15782,"IPAP, Seoul"),
    (15785,"Fukuoka U., Appl. Phys."),
    (15787,"ESA, Madrid"),
    (15792,"Ramon Llull U., Barcelona"),
    (15833,"Hanoi U."),
    (15854,"Hampton U."),
    (15903,"Belgrade U."),
    (15906,"VINCA Inst. Nucl. Sci., Belgrade"),
    (15939,"New Lisbon U."),
    (15966,"KwaZulu Natal U."),
    (15967,"Shanghai Jiao Tong U."),
    (15976,"Zacatecas U."),
    (15979,"Tokyo U., Math. Sci."),
    (15988,"UCM, Somosaguas, Dept. Phys."),
    (15991,"Favaloro U."),
    (15997,"Guangxi Normal U."),
    (16000,"Ilia State U."),
    (16005,"Valparaiso Ctr. Sci. Tech."),
    (16010,"Suranaree U. of Tech."),
    (16011,"ThEP, Bangkok"),
    (16013,"NCRA-TIFR, Pune"),
    (16014,"Semnan U."),
    (16016,"Yazd U."),
    (16023,"West Bengal State U."),
    (16027,"Rio Grande do Norte U."),
    (16034,"Nanchang U."),
    (16037,"Cumhuriyet U."),
    (16046,"U. Fed. Rio de Janeiro, Inst. Phys."),
    (16055,"BeiHang U."),
    (16058,"Stellenbosch U."),
    (16062,"Cape Town U., ACGC"),
    (16066,"North China Electric Power U."),
    (16069,"Colima U."),
    (16070,"Hebei U."),
    (16072,"Taiyuan U. of Tech."),
    (16073,"Addis Ababa U."),
    (16074,"Antioquia U."),
    (16078,"Barasat Govt. Coll."),
    (16083,"Tianjin U."),
    (16086,"Tamkang U."),
    (16087,"Taipei, Inst. Astron. Astrophys."),
    (16095,"Maranhao State U."),
    (16096,"UFMA, Sao Luis"),
    (16100,"Sao Carlos Federal U."),
    (16108,"Hua-Zhong Normal U., LQLP"),
    (16109,"Shandong U., Weihai"),
    (16119,"Netaji Nagar Day Coll."),
    (16120,"Chang Gung U."),
    (16122,"Andres Bello Natl. U."),
    (16126,"Inst. Phys. of Natl. Acad. Sci."),
    (16127,"Al Farabi Kazakh Natl. U."),
    (16129,"IAP"),
    (16130,"UWC"),
    (16132,"UWC, ICG"),
    (16135,"UC Riverside"),
    (16136,"Konkuk U."),
    (16140,"Madrid IFT"),
    (16146,"Zhejiang U. Tech."),
    (16151,"Chungnam Natl. U."),
    (16188,"Bhubaneswar, NISER"),
    (16223,"Suleyman Demirel U."),
    (16235,"Erzincan U."),
    (16236,"Yildiz Tech. U."),
    (16240,"Puerto Rico U., Mayaguez"),
    (16252,"Ceara U."),
    (16253,"Xinjiang U."),
    (16254,"Jiangsu Normal Coll."),
    (16256,"Taiwan, Chung Yuan Christian U."),
    (16259,"Lisbon, CFTP"),
    (16273,"Cracow Tech. U."),
    (16279,"Zagreb U., Phys. Dept."),
    (16285,"African Inst. Math. Sci., Cape Town"),
    (16288,"Tsukuba U., CCS"),
    (16289,"Toulon U."),
    (16293,"POSTECH"),
    (16297,"QUEST, Hannover"),
    (16309,"Himachal Pradesh U."),
    (16313,"MPI, Munich"),
    (16315,"RKMVU, West Bengal"),
    (16321,"Haifa U."),
    (16322,"Jamia Millia Islamia"),
    (16325,"Islamic Azad U., Chalous"),
    (16326,"TEI, Chalkida"),
    (16327,"Thessaly U."),
    (16328,"Razi U., Kermanshah"),
    (16332,"Kyungpook Natl.K U."),
    (16333,"Chunbuk Natl. U."),
    (16336,"Jordan U."),
    (16338,"U. British Columbia, Vancouver, Dept. Phys. Astron"),
    (16345,"Eurasian Nat. U., Astana"),
    (16346,"Beira Interior U., Covilha"),
    (16351,"Korea U., KODEL"),
    (16359,"Beijing, Inst. Phys."),
    (16361,"Portsmouth U., ICG"),
    (16363,"Tartu, Inst. Phys."),
    (16366,"Lyon U."),
    (16371,"Los Alamos National Laboratory (LANL)"),
    (16375,"Sao Paulo State U."),
    (16380,"Kyoto, U. RISH"),
    (16394,"Nagoya U., Solar-Terrestrial Environ. Lab."),
    (16395,"Rikkyo U., RCMAS"),
    (16399,"U. Oxford (main)"),
    (16400,"Nanjing U., Dept. Astron."),
    (16401,"Dublin Inst."),
    (16403,"Shanxi Datong U."),
    (16406,"Wake Forest Univ."),
    (16407,"Los Alamos National Laboratory"),
    (16408,"Fukuoka Inst. Tech."),
    (16409,"Tohoku U., Inst. Materials Res."),
    (16412,"Porto U., Astron. Dept."),
    (16414,"Inst. Theor. Astrophys., Oslo"),
    (16418,"CICATA-Legaria, IPN"),
    (16422,"Tait Inst., Edinburgh"),
    (16423,"Maxwell Inst. Math. Sci., Edinburgh"),
    (16424,"Heriot-Watt U."),
    (16427,"In2P3, France"),
    (16430,"Pablo de Olavide U., Seville"),
    (16431,"Huelva U."),
    (16432,"Vicosa Federal U."),
    (16434,"Department of Physics and Astronomy, University of Waterloo"),
    (16445,"Athens Academy"),
    (16449,"LNM Inst. Info. Tech."),
    (16450,"Hokkai-Gakuen U."),
    (16457,"Center of Quantum Universe, Faculty of Science, Okayama University, Research Core for Extreme Quantum World, Okayama University"),
    (16460,"Jijel U."),
    (16462,"Evora U."),
    (16469,"Durham U., Dept. of Math."),
    (16471,"Taiwan, Natl. Dong Hwa U."),
    (16472,"Shimane U."),
    (16473,"Ulaanbaatar U."),
    (16475,"Henan Inst. Sci. Technol."),
    (16476,"Korea Air Force Academy"),
    (16477,"IPhT Saclay"),
    (16483,"Balseiro Inst., San Carlos de Bariloche"),
    (16487,"Liverpool U., Dept. Math."),
    (16493,"Charles U., Inst. Theor. Phys."),
    (16495,"Helmholtz Inst., Jena"),
    (16499,"Mar del Plata U."),
    (16501,"Weizmann Institute"),
    (16502,"Santander Industrial U."),
    (16504,"United Arab Emirates U."),
    (16509,"Yantai U."),
    (16514,"U. Santiago de Compostela, Dept. Part. Phys."),
    (16515,"U. Santiago de Compostela, IGFAE"),
    (16516,"Hebei Normal U."),
    (16518,"East China U. Sci. Tech."),
    (16520,"TAPIR, Caltech"),
    (16523,"RCNS, Sendai"),
    (16525,"IISER-TVM"),
    (16528,"INFN, Padova"),
    (16529,"Groningen U., KVI"),
    (16530,"Cracow,INP"),
    (16531,"Hanoi U. of Sci."),
    (16532,"Celal Bayar U."),
    (16537,"Talca U."),
    (16539,"Piaui U."),
    (16543,"DARK Cosmology Ctr."),
    (16546,"Ceara State U."),
    (16547,"IFCE, Ceara"),
    (16548,"CEFETCE, Juazeiro do Norte"),
    (16554,"Modane, Lab. Souterrain"),
    (16556,"IUF, Paris"),
    (16558,"HIAST"),
    (16560,"Minsk, Inst. Nucl. Problems"),
    (16562,"SoongSil U."),
    (16571,"Hanoi, Inst. Phys."),
    (16574,"Oxford U., Theor. Phys."),
    (16575,"Zhejiang U., Inst. Mod. Phys."),
    (16576,"Hangzhou, Zhejiang U."),
    (16579,"Inst. Nucl. Theory, Seattle"),
    (16580,"Lyon Observ."),
    (16581,"Nagoya U., Math. Dept."),
    (16582,"CUPT, Chongqing"),
    (16585,"Huangshan U."),
    (16586,"Liaoning U."),
    (16587,"Zhengzhou U."),
    (16590,"Punjab U., CHEP"),
    (16591,"Hunan U."),
    (16592,"Hangzhou Normal U."),
    (16593,"Sichuan U., Inst. Nucl. Sci. Tech."),
    (16594,"Shanxi U."),
    (16595,"Henan U."),
    (16598,"Soochow U."),
    (16601,"ITA, S. Jose' dos Campos"),
    (16602,"Ferdowsi U."),
    (16604,"Korea Nat. U. Transport., Chungju"),
    (16610,"Naresuan U."),
    (16612,"Murcia U."),
    (16614,"Natl. Ctr. Space Weather, Beijing"),
    (16619,"Chonbuk Natl. U."),
    (16622,"Myong Ji U."),
    (16632,"NCTS, Taipei"),
    (16633,"JARA, Aachen"),
    (16635,"Caracas, U. Central"),
    (16641,"DIC, Universidad de Guanajuato"),
    (16642,"CUCEI, Universidad de Guadalajara"),
    (16643,"Nippon Medical School"),
    (16644,"Namur U."),
    (16646,"Samarkand State U."),
    (16647,"Adolfo Ibanez U."),
    (16648,"Chile Austral U., Valdivia"),
    (16649,"Luxembourg U."),
    (16650,"Joint Inst. Power Nucl. Res., Minsk"),
    (16651,"IPT, Kazakstan"),
    (16655,"Gakushuin U."),
    (16656,"Pernambuco U."),
    (16658,"IAS"),
    (16662,"Ohio State University"),
    (16665,"Hong Kong U. Sci. Tech."),
    (16667,"IIP, Brazil"),
    (16673,"Renmin U. of China"),
    (16674,"Amir Kabir U. Tech., Tehran"),
    (16676,"CSSM, Adelaide U."),
    (16677,"Shenyang, Northeast U. Tech."),
    (16678,"University of Canterbury"),
    (16679,"nee Kagramanova"),
    (16682,"Carleton University"),
    (16684,"Plymouth U."),
    (16691,"Cambridge U., Inst. of Astron."),
    (16695,"UAEH, Pachuca"),
    (16696,"Morelos State U."),
    (16697,"Kumamoto Health Sci. U."),
    (16699,"U. Wales, Cardiff"),
    (16700,"Unlisted, FR"),
    (16703,"Aichi Medical U."),
    (16704,"Campina Grande Federal U."),
    (16705,"Paraiba State U."),
    (16706,"CEFET, Maranhao"),
    (16707,"Phys-ENS"),
    (16709,"Shandong U. Sci. Tech."),
    (16710,"IIT, Roorkee"),
    (16711,"Roorkee U."),
    (16712,"Beijing, North China Elec. Power U."),
    (16713,"Beijing, Inst. Appl. Phys."),
    (16715,"Alagoas U."),
    (16716,"Bishop's U., Sherbrooke"),
    (16717,"Paris, Lab. Kastler Brossel"),
    (16720,"Algarve U., CENTRA"),
    (16721,"Rhodes U."),
    (16722,"Seoul, Nat. U. Technol."),
    (16723,"Al-Azhar U., Cairo"),
    (16724,"Mexico U., IIMAS"),
    (16726,"Aichi U."),
    (16731,"NUST, Islamabad"),
    (16732,"Cruzeiro do Sul U."),
    (16733,"IISER, Trivandrum"),
    (16735,"Farmingdale State U."),
    (16742,"Biobio U."),
    (16745,"Mexico, ESFM"),
    (16746,"Juarez Autonoma de Tabasco U."),
    (16750,"Bialystok U."),
    (16752,"Boulby Underground Lab."),
    (16756,"Giessen Univ."),
    (16757,"Kiev U."),
    (16758,"NASU, Kiev, KINR"),
    (16759,"AAAS, Washington, D.C."),
    (16769,"Inje U."),
    (16773,"Sao Paulo U., Guaratingueta"),
    (16774,"Xian Jiaotong U."),
    (16775,"Jinan U."),
    (16778,"Sarajevo U."),
    (16783,"The University of Texas at Dallas"),
    (16784,"Algarve U."),
    (16787,"Kurdistan U."),
    (16788,"RIAAM, Maragha"),
    (16790,"Nigde U."),
    (16791,"Mahidol U."),
    (16792,"Kavli Institute for Cosmological Physics, Department of Astronomy and Astrophysics, Enrico Fermi Institute, University of Chicago"),
    (16795,"Karadeniz U."),
    (16796,"Baku State U."),
    (16798,"Kocaeli U."),
    (16799,"Inha U."),
    (16801,"Tokyo Kasei U."),
    (16802,"Shahid Madani U., Azarbaijan"),
    (16803,"Copernicus Ctr., Cracow"),
    (16804,"Szczecin U."),
    (16805,"Szeged U."),
    (16814,"Srinakharinwiroth U."),
    (16818,"Uludag U."),
    (16819,"Railmajra, Rayat Inst. Eng. Info. Tech."),
    (16820,"Sonora U."),
    (16824,"ETH Zurich"),
    (16828,"Pierre Auger Observ."),
    (16832,"Station Radioastronomy, Nancay"),
    (16834,"Natl. Tech. U., San Rafael"),
    (16838,"L'Aquila U."),
    (16839,"INST, Hanoi"),
    (16843,"UEFS, Feira de Santana"),
    (16847,"Rosario U."),
    (16848,"LIDAR CITEFA"),
    (16849,"Bahia U."),
    (16852,"Chiapas Autonoma U."),
    (16854,"UC Irvine"),
    (16864,"Rzeszow U."),
    (16865,"Edinburgh U., Sch. Math."),
    (16866,"Sardar Patel U."),
    (16867,"Alicante U."),
    (16868,"Mumbai U."),
    (16869,"Benha U."),
    (16872,"RCAAM, Academy of Athens"),
    (16874,"Azarbaijan U. of Tarbiat Moallem"),
    (16875,"Cote d'Azur Observ., Nice"),
    (16876,"Itajuba Federal U."),
    (16882,"Rajamangala U. Tech. Isan"),
    (16884,"Lianyungang Teacher's Coll."),
    (16885,"Prague, Inst. Plasma Phys."),
    (16887,"Bejaia U."),
    (16888,"Lisbon U., CAAUL"),
    (16889,"Paris U., IV"),
    (16890,"Applied Mathematics Inc., USA"),
    (16894,"BITS, Pilani"),
    (16895,"Zielonogorski U."),
    (16899,"Chiba Inst. Tech."),
    (16902,"King Saud U."),
    (16903,"Mazandaran U., Babolsar"),
    (16906,"Natl.Res. U., Moscow"),
    (16908,"Minas Gerais U."),
    (16909,"Newcastle upon Tyne U."),
    (16911,"Durham U., CPT"),
    (16912,"Eastern Mediterranean U."),
    (16913,"Queen Mary, U. of London, Math. Sci."),
    (16914,"Carlos III U., Madrid"),
    (16917,"ETHZ"),
    (16922,"JAXA, Tokyo"),
    (16926,"Shanghai U."),
    (16927,"Beijing, Inst. Tech."),
    (16928,"Lisbon, ISEL"),
    (16929,"Lisbon U., CFTC"),
    (16931,"Nice Sophia Antipolis U."),
    (16935,"Sao Jose, INPE"),
    (16936,"Diadema, Sao Paulo Fed. U."),
    (16938,"Aristotle University of Thessaloniki"),
    (16939,"MPI for Astrophysics, Garching"),
    (16952,"Rennes U."),
    (16961,"Warsaw U., Bialystok"),
    (16963,"Warsaw, Inst. Math."),
    (16964,"Bhat, Inst. Plasma Res."),
    (16965,"Strathclyde U."),
    (16966,"ESPCI, Paris"),
    (16967,"Cordoba Observ."),
    (16970,"NIMS, Daejeon"),
    (16972,"Raja Ramanna Ctr."),
    (16973,"West Scotland U."),
    (16974,"Inst. of Astron., Zielona Gora"),
    (16975,"Andrews U."),
    (16979,"Goyang, Korea Aerospace U."),
    (16980,"Oran U."),
    (16982,"Plymouth U., Math. Stat. Dept."),
    (16983,"Costa Rica U."),
    (16984,"Xinyang Norm. U."),
    (16985,"SwissScientific"),
    (16986,"INFN,  Rome"),
    (16992,"Paris, U. XIII"),
    (16997,"Prague, Math. Inst."),
    (16998,"Lviv State U., Astron. Observ."),
    (16999,"Lisboa U., CFNUL"),
    (17002,"Miguel Hernandez U."),
    (17003,"Para U."),
    (17005,"903392"),
    (17006,"Madrid, ICM"),
    (17007,"GIST, Gwangju"),
    (17009,"ICC, Durham"),
    (17010,"IPPP, Durham"),
    (17013,"INFN, Padua; Padua U."),
    (17014,"Sao Joao U., Campinas"),
    (17017,"Nottingham U., Malaysia"),
    (17019,"IEU, Seoul"),
    (17022,"IPN, Lyon"),
    (17023,"Antofagasta U."),
    (17027,"Qatar U."),
    (17029,"IBS, Daejeon"),
    (17031,"KRISS, Taejon"),
    (17032,"Seoultech"),
    (17033,"Pelotas U."),
    (17034,"Alfenas Fed. U., Pocos de Caldas"),
    (17035,"CICQM, Beijing"),
    (17038,"Sud Toulon Var U."),
    (17039,"nÃ©e Kagramanova"),
    (17040,"Zhanjiang Normal Coll."),
    (17041,"ULA"),
    (17044,"Taiwan, Shu Zen Coll. Med. Mgt."),
    (17045,"Southeast U., Nanjing"),
    (17050,"LSBB, Rustrel"),
    (17051,"Helwan U."),
    (17053,"Jilin U."),
    (17055,"Tsukuba Space Center/JAXA"),
    (17056,"Kumamoto U."),
    (17058,"Bohai U."),
    (17065,"Cheju Natl. U."),
    (17068,"Kiev Polytechnic Inst."),
    (17069,"U. Coll. London"),
    (17075,"Beijing U. of Tech."),
    (17077,"Wroclaw U., Astro. Inst."),
    (17079,"Catolica del Norte U."),
    (17080,"KASI, DaeJeon"),
    (17081,"Badji Mokhtar U."),
    (17082,"Osaka Inst. Tech."),
    (17083,"IAP and IHES"),
    (17084,"U Florida"),
    (17085,"U. Maryland, College Park"),
    (17086,"IBS, Daejon"),
    (17088,"Shanghai United Ctr. Astrophys."),
    (17095,"Caracas, IIEA"),
    (17096,"Mexico U., CEN"),
    (17098,"Natl. Astron. Observ., Bogota"),
    (17101,"Pretoria, CSIR"),
    (17102,"Baskent U."),
    (17103,"Zhenjiang, Jiangsu U."),
    (17104,"Natl. Supercomputing Ctr., Tianjin"),
    (17105,"Beijing, CITSEC"),
    (17108,"Zululand U."),
    (17109,"Hubei U."),
    (17112,"CP3-Origins, Odense"),
    (17116,"Europea de Madrid U."),
    (17117,"CEFET, Rio de Janeiro"),
    (17118,"Tartu U."),
    (17119,"Indian Inst. Tech., Kharagpur"),
    (17127,"Budapest, Tech. U."),
    (17128,"Constantine U."),
    (17130,"Taiwan, Natl. Normal U."),
    (17131,"Northeastern Hill U., Shillong"),
    (17133,"Meisei U."),
    (17135,"Valle U., Cali"),
    (17136,"Hadassah Coll., Jerusalem"),
    (17137,"Ruppin Acad. Ctr."),
    (17138,"Natl. U. Educ., Gwangju"),
    (17142,"Shanghai Norrmal U."),
    (17143,"Shanghai Ocean U."),
    (17146,"Perimeter/Waterloo"),
    (17147,"NUAA, Nanjing"),
    (17148,"Lusofona U."),
    (17149,"Dept. of Physics, University of Oregon"),
    (17150,"Tafresh U."),
    (17151,"Lyon, IPN, France"),
    (17154,"Belgrade, Inst. Phys."),
    (17155,"Nazarbayev U., Astana"),
    (17156,"Vienna U., Dept. Math."),
    (17157,"Parthenope U., Naples"),
    (17158,"Tbilisi, Inst.Phys."),
    (17161,"NITheP, Matieland"),
    (17164,"Biruni Observ."),
    (17165,"Razmadze Math. Inst."),
    (17167,"Iran U. Sci. Tech."),
    (17169,"Indonesia U."),
    (17170,"Surrey U., Math. Stat. Dept."),
    (17171,"Kyung Hee U."),
    (17172,"Shenzhen U."),
    (17174,"Chengdu U. Of Tech."),
    (17178,"Hong Kong U."),
    (17179,"PUC, Minas Gerais"),
    (17182,"Gomel State U."),
    (17183,"Gomel State Tech. U., ICTP"),
    (17185,"University of Texas at Austin"),
    (17186,"Goias U."),
    (17187,"Tufts University"),
    (17188,"Campinas U."),
    (17191,"Brookhaven National Laboratory"),
    (17192,"Otterbein College"),
    (17198,"Villa Elisa, Inst. Argentino Radioastron"),
    (17199,"Cachan, Ecole Normale Superieure"),
    (17200,"Tarapaca U."),
    (17201,"Kitasato U."),
    (17203,"Tashkent, Astron. Inst."),
    (17204,"UFT, Palmas"),
    (17210,"Paris U., VI, LPTL"),
    (17214,"Three Gorges U."),
    (17215,"Jingzhou, Yangtze U."),
    (17216,"Indian Inst. Tech, Hyderabad"),
    (17217,"Kinki U., Iizuka"),
    (17218,"Kent U."),
    (17219,"Canakkale Onsekiz Mart U."),
    (17220,"Can Tho U."),
    (17221,"Hanoi Ed. U."),
    (17222,"SUNY, Utica/Rome"),
    (17224,"Otterbein Coll."),
    (17226,"London, City U."),
    (17228,"Bilkent U."),
    (17229,"University Coll, London"),
    (17230,"Siksha O Anusandhan U., Bhubaneswar"),
    (17232,"Lisbon, LIFEP"),
    (17233,"U.Tech.Natl., Argentina"),
    (17234,"CUNY, Lehman Coll."),
    (17237,"Experimental Particle Physics Department, Stefan Inst., Ljubljana"),
    (17239,"IFIR, Rosario"),
    (17242,"Indian Inst. Tech., Indore"),
    (17243,"Oldenburg, U."),
    (17245,"Lavras Federal U."),
    (17250,"Innsbruck U., Quant. Opt. and Info."),
    (17251,"Amazonas U."),
    (17256,"Abastumani Astrophys. Observ."),
    (17258,"Nanyang Technol. U."),
    (17259,"South China U. Tech."),
    (17261,"Hunan, LDQSQC"),
    (17262,"Belgrade Observ."),
    (17264,"Shizuoka U. of Welfare"),
    (17268,"Jangipur Coll."),
    (17269,"Kalyani U."),
    (17270,"Hua-Zhong U. Sci. Tech."),
    (17274,"Sternberg Astronomical Imstitute, Moscow, Russia"),
    (17275,"Chung-Ang U."),
    (17276,"Xiamen U."),
    (17278,"Istanbul Aydin U."),
    (17279,"Ho Chi Minh City U."),
    (17280,"King's Coll. London, Dept. Math"),
    (17284,"Bhubaneswar, Regional Coll. of Educ."),
    (17285,"Nanjing, Xiaozhuang Coll."),
    (17286,"Nantong U."),
    (17288,"Ciudad U., ETSI Navales"),
    (17289,"CERN, Geneva"),
    (17290,"Qufu Normal U."),
    (17292,"Azad U., Marvdasht"),
    (17294,"Iceland U."),
    (17302,"Mato Grosso U."),
    (17305,"Nanyang, Norm. U."),
    (17306,"Department of Physics â€œE. Fermi,â€ University of Pisa , Largo B. Pontecorvo 3, 56127 Pisa, Italy"),
    (17307,"INFN-Istituto Nazionale di Fisica Nucleare , Sezione di Pisa, Largo B. Pontecorvo 3, 56127 Pisa, Italy"),
    (17308,"Jet Propulsion Laboratory, California Institute of Technology , 4800 Oak Grove Drive, Pasadena, California 91109, USA"),
    (17309,"Thales Alenia Space Italia , Strada Antica di Collegno 253, 10146 Torino, Italy"),
    (17310,"California Institute of Technology , Pasadena, California 91109, USA"),
    (17311,"INAF-Istituto Nazionale di Astrofisica , IAPS, Via Fosso del Cavaliere 100, 00133 Roma, Italy"),
    (17315,"Bucharest, Tech. U."),
    (17318,"Ambedkar, Nat. Inst. Technol."),
    (17319,"Gama Research Ctr., Yogyakarta"),
    (17322,"Malaysia, Sci. U."),
    (17324,"University of Valencia"),
    (17326,"Tribhuvan U."),
    (17327,"Keimyung U."),
    (17330,"Londrina U."),
    (17331,"NAS Armenia, Yerevan"),
    (17332,"Namibia U."),
    (17334,"Potchefstroom U."),
    (17337,"Leicester U."),
    (17339,"Nicholas Copernicus U."),
    (17340,"Free State U."),
    (17346,"Henan U. of Tech."),
    (17347,"Shahrood U."),
    (17348,"Islamic Azad U., Qom"),
    (17349,"Astrium Ltd., Stevenage"),
    (17350,"K.N. Toosi U."),
    (17351,"Kashan U."),
    (17352,"Zhejiang Normal U."),
    (17353,"Tibet U."),
    (17354,"Yunnan U., Astrophys. Ctr."),
    (17355,"Southwest Jiaotong U."),
    (17357,"IIT Kharagpur, India"),
    (17359,"Yamaguchi U."),
    (17360,"Atilim U."),
    (17362,"School of Physical Science and Technology, Southwest Jiaotong University , Chengdu 610031, China"),
    (17363,"IFSEMG, Juiz de Fora"),
    (17366,"Gunsan Natl. U."),
    (17367,"Belarussian State Pedag. U."),
    (17368,"Sao Paulo, Inst. Astron. Geofis."),
    (17370,"IISER, Mohali"),
    (17371,"Department of Physics, School of Civil Engineering and Architecture, Institute of Astronomy, Nanchang University ,Nanchang 330031, China"),
    (17373,"Ningbo U."),
    (17374,"Max-Planck Institut fÃ¼r extraterrestrische Physik , PO Box 1312, GiessenbachstraÃŸe 1, D-85748 Garching, Germany"),
    (17375,"UniversitÃ© de Toulouse , UPS-OMP, IRAP, F-31028 Toulouse CEDEX 4, France"),
    (17376,"CNRS , IRAP, 9 Av. Colonel Roche, BP 44346, F-31028 Toulouse CEDEX 4, France"),
    (17377,"Jet Propulsion Laboratory, California Institute of Technology , Pasadena, California 91109, USA"),
    (17378,"Warsaw University Observatory , Aleje Ujazdowskie 4, 00 - 478 Warszawa, Poland"),
    (17379,"Physics Department, Moscow State University , Moscow 119991, Russia"),
    (17380,"Tsiolkovskii Russian State Technological University , Orshanskaya Street, 3, Moscow 121552, Russia"),
    (17381,"Arya Mehr U., Tehran"),
    (17382,"School of Physics, University College Dublin , Belfield, Dublin 4, Ireland"),
    (17383,"Department of Physics and Space Sciences, Florida Institute of Technology , Melbourne, Florida 32901, USA"),
    (17384,"Center for Space Plasma and Aeronomic Research, University of Alabama in Huntsville , 320 Sparkman Drive, Huntsville, ),Alabama 35805, USA"),
    (17385,"University of Alabama in Huntsville , Huntsville, Alabama 35812, USA"),
    (17386,"Max-Planck-Institut fÃ¼r extraterrestrische Physik , Giessenbachstrasse 1, 85748 Garching, Germany"),
    (17387,"Beijing, Acad. Math. Syst. Sci."),
    (17389,"Ioffe Institute , Polytekhnicheskaya 26, 194021 St. Petersburg, Russia"),
    (17390,"St. Petersburg State Polytechnical University , Polytekhnicheskaya 29, 195251 St. Petersburg, Russia"),
    (17392,"Central South U., Changsha"),
    (17393,"Anyang Norm U."),
    (17394,"Institut dâ€™Astronomie et dâ€™Astrophysique, CP-226, UniversitÃ© Libre de Bruxelles , 1050 Brussels, Belgium"),
    (17395,"Institut dâ€™Astronomie et dâ€™Astrophysique, CP-226, UniversitÃ© Libre de Bruxelles , 1050 Brussels, Belgium and Department of Physics and Astronomy, Macalester College , 1600 Grand Avenue, Saint Paul, Minnesota 55105, USA"),
    (17396,"CEA , DAM, DIF, F-91297 Arpajon, France"),
    (17397,"Institute of Theoretical Physics, Faculty of Mathematics and Physics Charles University in Prague , V HoleÅ¡oviÄkÃ¡ch 2 180 00 Praha 8, Czech Republic"),
    (17398,"American U., Sharjah"),
    (17400,"Centre for Quantum Computation and Communication Technology, School of Mathematics and Physics, The University of Queensland , St. Lucia 4072, Queensland, Australia"),
    (17401,"Laboratory of Fundamental Physical Quantities Measurement, School of Physics, Huazhong University of Science and Technology , Wuhan 430074, China"),
    (17402,"Universidade do Estado do Rio de Janeiro , Instituto de FÃ­sica, Departamento de FÃ­sica TeÃ³rica, Cep 20550-013, Rio de Janeiro, Rio de Janeiro, Brazil"),
    (17403,"Universidade Federal do Estado do Rio de Janeiro , Centro de CiÃªncias Exatas e Tecnologia, Departamento de InformÃ¡tica Aplicada, Cep 22290-040, Rio de Janeiro, Rio de Janeiro, Brazil"),
    (17404,"Izmir, Yasar U."),
    (17405,"Akita, Pref. U."),
    (17406,"Warsaw, Inst. Phys."),
    (17408,"P4, Chile"),
    (17409,"Hefei, NSRL"),
    (17413,"Istituto di Astrofisica e Planetologia Spaziali, Istituto Nazionale di Astrofisica, (IAPS/INAF), Via del Fosso del Cavaliere 100, 00133 Roma, Italy, Istituto di Scienza e Tecnologie dellâ€™Informazione, Consiglio Nazionale delle Ricerche, (ISTI/CNR), Via G. Moruzzi 1, 56124 Pisa, Italy, and Istituto Nazionale di Fisica Nucleare (INFN), Sezione di Pisa, Largo B. Pontecorvo 3, 56127 Pisa, Italy"),
    (17414,"Advanced Research Institute for Science and Engineering, Waseda University, 3-4-1 Okubo, Shinjuku, Tokyo 169-8555,Japan"),
    (17415,"Space Research Institute of Russian Academy of Sciences, Profsoyuznaya 84/32, Moscow 117997, Russia and National Research Nuclear University MEPhI, Kashirskoe Shosse 31, Moscow 115409, Russia"),
    (17416,"Department of Physics and Astronomy, University of Waterloo , Waterloo, Ontario N2L 3G1, Canada; Canadian Institute for Theoretical Astrophysics, University of Toronto , Toronto, Ontario M5S 3H8, Canada, and Perimeter Institute for Theoretical Physics , Waterloo, Ontario N2L 2Y5, Canada"),
    (17417,"Leipzig University, Institute for Theoretical Physics, 04109 Leipzig, Germany"),
    (17418,"Centre for Theoretical Cosmology, Department of Applied Mathematics and Theoretical Physics, University of Cambridge,Wilberforce Road, Cambridge CB3 0WA, United Kingdom"),
    (17419,"Theoretical Particle Physics and Cosmology Group, Physics Department, Kings College London, Strand, London WC2R 2LS,United Kingdom"),
    (17420,"Department of Astronomy and Atmospheric Sciences, Kyungpook National University, Daegu 702-701, Republic of Korea"),
    (17421,"Division of Science Education and Institute of Fusion Science, Chonbuk National University, Jeonju 561-756, Republic of Korea")]

for id, aff in fix_it:
    create_affiliation_entry_aps(id, aff)

impact_db.commit()
impact_db.close()
